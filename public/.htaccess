# Apache SPA fallback configuration
RewriteEngine On
RewriteBase /

# Handle CORS preflight requests
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

# Prevent rewriting of API routes
RewriteRule ^api/ - [L]
RewriteRule ^supabase/ - [L]

# Prevent rewriting of static assets
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# Prevent rewriting of directories
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Prevent rewriting of common file extensions
RewriteRule \.(js|css|png|jpg|jpeg|gif|svg|ico|woff|woff2|ttf|eot|txt|pdf|zip|mp4|webm|ogg)$ - [L]

# SPA fallback - all other routes go to index.html
RewriteRule ^ index.html [L]